!function(t){"use strict";function e(t){var e;return"canvas"!==t.tagName?(e=document.createElement("canvas"),e.width=t.naturalWidth,e.height=t.naturalHeight,e.getContext("2d").drawImage(t,0,0)):e=t,e.toDataURL("image/png")}function n(t){if(document.createEvent){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0),t.dispatchEvent(e)}else t.click()}function i(t,i,r){function o(t){if(setTimeout(function(){s.removeEventListener("click",o,!0)}),r)return r(t)}var s=document.createElement("a");document.body.appendChild(s),s.href=e(t),s.download=i,s.addEventListener("click",o),n(s)}function r(t){return N.test(t)?t.toLowerCase():T.test(t)?(o(t)||t).toLowerCase():C.test(t)?s(t).toLowerCase():t.toLowerCase()}function o(t){return t.replace(A,function(t,e){return e?" "+e:""})}function s(t){return t.replace(k,function(t,e,n){return e+" "+n.toLowerCase().split("").join(" ")})}function a(t){return H(t).replace(/[\W_]+(.|$)/g,function(t,e){return e?" "+e:""}).trim()}function u(t){return O(t).replace(/\s(\w)/g,function(t,e){return e.toUpperCase()})}function l(t,e,n){var i=F[e];if("undefined"==typeof i&&(i=f(e)),i){if(void 0===n)return t.style[i];t.style[i]=R(i,n)}}function c(t,e){for(var n in e)e.hasOwnProperty(n)&&l(t,n,e[n])}function f(t){var e=U(t),n=z(e);return F[e]=F[t]=F[n]=n,n}function h(){2===arguments.length?"string"==typeof arguments[1]?arguments[0].style.cssText=arguments[1]:c(arguments[0],arguments[1]):l(arguments[0],arguments[1],arguments[2])}function p(t){this.listeners={},this.__context=t||this}function d(t){return!("object"!=typeof t||!t.tagName||"input"!==t.tagName.toLowerCase())}function m(t,e){return v(t),t.parentNode.insertBefore(e,t),t}function v(t){W(t,{width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute","z-index":-1})}function g(t,e){"string"==typeof e?t.innerHTML=e:(t.innerHTML="",t.appendChild(e))}function y(t,e){return new G(t,e)}function b(t,e){return new Z(t,e)}var w=null,L=["Webkit","Moz","O","ms"],E=function(t){w||(w=document.createElement("div"));var e=w.style;if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),i=L.length;i>=0;i--){var r=L[i]+n;if(r in e)return r}return!1},x=r,N=/\s/,T=/(_|-|\.|:)/,C=/([a-z][A-Z]|[A-Z][a-z])/,A=/[\W_]+(.|$)/g,k=/(.)([A-Z]+)/g,H=x,M=a,O=M,_=u,j={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0},I=function(t,e){return"number"!=typeof e||j[t]?e:e+"px"},z=E,U=_,F={float:"cssFloat"},R=I,W=h,P=h,S=function(t,e){return Array.isArray(e)?e.reduce(function(e,n){return e[n]=l(t,n||""),e},{}):l(t,e||"")};W.set=P,W.get=S,p.prototype={constructor:p,on:function(t,e){return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),this},one:function(t,e){function n(){return e.apply(this,arguments),this.off(t,n),this}return this.on(t,n)},emit:function(t){var e=this;if("undefined"==typeof this.listeners[t]||!this.listeners[t].length)return this;var n=Array.prototype.slice.call(arguments,1),i=this.listeners[t].length;do e.listeners[t][--i].apply(e.__context,n);while(i);return this},off:function(t,e){return void 0!==this.listeners[t]&&this.listeners[t].length?(this.listeners[t]=this.listeners[t].filter(function(t){return t!==e}),this):this},dispose:function(){var t=this;for(var e in this)t[e]=null}};var D=p,G=function(t){function e(e,n){function i(t){function n(t){var e=new Image,n=window.URL||window.webkitURL,s=n.createObjectURL(t);e.src=s,r.push(s),o.push(e),e.onload=function(){--i||(u("load",o),setTimeout(function(){r.forEach(function(t){n.revokeObjectURL(t)})}))}}u("loading");var i=e.files.length,r=[],o=[];[].slice.call(e.files).forEach(n)}var r=this;if(void 0===n&&(n={}),t.call(this),!d(e))throw new TypeError(e+" is not an input element.");var o=this.label=document.createElement("label");if(this.input=e,n.id)this.id=n.id;else if(e.hasAttribute("id")){var s=e.getAttribute("id");s.length?this.id=e.getAttribute("id"):this.id="dom-image-file-opener"}if("boolean"==typeof n.multiple)this.multiple=n.multiple;else if(e.hasAttribute("multiple")){var a=e.getAttribute("multiple");a.length&&(this.multiple=a)}"string"==typeof n.className&&(this.className=n.className),e.setAttribute("type","file"),W(o,{cursor:"pointer"}),n.innerHTML?this.innerHTML=n.innerHTML:this.innerHTML.length||(this.innerHTML="Open Image"),m(e,o);var u=function(t,e){return r.emit(t,e)};e.addEventListener("change",i,!1),this.destroy=function(){return e.removeEventListener("change",i,!1),o.parentNode.removeChild(o),e}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={innerHTML:{},id:{},parent:{},className:{},multiple:{}};return e.prototype.html=function(t){return t?void g(this.label,t):this.label.innerHTML},n.innerHTML.get=function(){return this.label.innerHTML},n.innerHTML.set=function(t){this.label.innerHTML=t},n.id.set=function(t){this.input.setAttribute("id",t),this.label.setAttribute("for",t)},n.id.get=function(){return this.input.getAttribute("id")},n.parent.get=function(){return this.input.parentNode},n.className.get=function(){return this.label.className},n.className.set=function(t){this.label.className=t},n.multiple.set=function(t){this.input.setAttribute("multiple",t)},Object.defineProperties(e.prototype,n),e}(D),Z=function(t){function n(n,i){function r(t){t.targetTouches&&t.preventDefault(),u("save",l)}var o=this;if(t.call(this),!d(n))throw new TypeError(n+" is not an input element.");i=i||{};this.input=n;var s=this.link=document.createElement("a"),a=document.createElement("span");a.appendChild(s),s.href="#",this.html(i.html||"Save File"),m(n,a),this.name=i.name||"image.png",W(s,{"text-decoration":"none",color:"black"});var u=function(t,e){return o.emit(t,e)};s.addEventListener("mousedown",r,!1),s.addEventListener("touchstart",r,!1);var l={saveAs:function(t,i){t&&(s.href=e(t),s.download=i,n.value=i)}};this.destroy=function(){return s.removeEventListener("click",onClick,!1),a.parentNode.removeChild(a),n}}t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n;var i={className:{}};return n.prototype.html=function(t){return t?void g(this.link,t):this.link.innerHTML},i.className.get=function(){return this.container.className},i.className.set=function(t){this.container.className=t},Object.defineProperties(n.prototype,i),n}(D);t.imageOpener=y,t.imageSaver=b,t.saveImage=i}(this.domImageFile=this.domImageFile||{});